(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["SearchResult"],{"14ae":function(t,e,r){},"2ab1":function(t,e,r){"use strict";r("14ae")},"31eb":function(t,e,r){t.exports=r.p+"img/custom-empty-image.png"},"99af4":function(t,e,r){"use strict";var i=r("23e7"),s=r("d039"),n=r("e8b5"),a=r("861d"),o=r("7b0b"),c=r("50c4"),l=r("8418"),f=r("65f0"),d=r("1dde"),u=r("b622"),h=r("2d00"),p=u("isConcatSpreadable"),g=9007199254740991,m="Maximum allowed index exceeded",v=h>=51||!s((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),y=d("concat"),w=function(t){if(!a(t))return!1;var e=t[p];return void 0!==e?!!e:n(t)},k=!v||!y;i({target:"Array",proto:!0,forced:k},{concat:function(t){var e,r,i,s,n,a=o(this),d=f(a,0),u=0;for(e=-1,i=arguments.length;e<i;e++)if(n=-1===e?a:arguments[e],w(n)){if(s=c(n.length),u+s>g)throw TypeError(m);for(r=0;r<s;r++,u++)r in n&&l(d,u,n[r])}else{if(u>=g)throw TypeError(m);l(d,u++,n)}return d.length=u,d}})},a434:function(t,e,r){"use strict";var i=r("23e7"),s=r("23cb"),n=r("a691"),a=r("50c4"),o=r("7b0b"),c=r("65f0"),l=r("8418"),f=r("1dde"),d=f("splice"),u=Math.max,h=Math.min,p=9007199254740991,g="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var r,i,f,d,m,v,y=o(this),w=a(y.length),k=s(t,w),C=arguments.length;if(0===C?r=i=0:1===C?(r=0,i=w-k):(r=C-2,i=h(u(n(e),0),w-k)),w+r-i>p)throw TypeError(g);for(f=c(y,i),d=0;d<i;d++)m=k+d,m in y&&l(f,d,y[m]);if(f.length=i,r<i){for(d=k;d<w-i;d++)m=d+i,v=d+r,m in y?y[v]=y[m]:delete y[v];for(d=w;d>w-i+r;d--)delete y[d-1]}else if(r>i)for(d=w-i;d>k;d--)m=d+i-1,v=d+r-1,m in y?y[v]=y[m]:delete y[v];for(d=0;d<r;d++)y[d+k]=arguments[d+2];return y.length=w-i+r,f}})},e844:function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"search-container"},[r("TopDiscount"),r("van-sticky",[r("HeaderNav",{attrs:{showBack:!0}}),r("div",{staticClass:"sort-wrap"},[t.filterAttr&&0!=t.filterAttr.length?t._e():r("div",{staticClass:"product-total-wrap"},[r("div",{staticClass:"category-name van-ellipsis"},[t._v(t._s(t.searchKey))]),r("div",{staticClass:"product-total"},[t._v("("+t._s(t.pageInfo?t.pageInfo.amount:0)+")")])]),r("van-dropdown-menu",{attrs:{"active-color":"#f2270c"}},[r("van-dropdown-item",{attrs:{options:t.optionSort,title:t.$t("list.sortTitle")},on:{change:t.sortValueChange},model:{value:t.sortValue,callback:function(e){t.sortValue=e},expression:"sortValue"}}),t.filterAttr&&t.filterAttr.length>0?r("van-dropdown-item",{ref:"filterDropdown1",attrs:{title:t.filterAttr[0].des},on:{close:t.filterColse}},[r("div",{staticClass:"filter-attr-item"},t._l(t.filterAttr[0].dmList,(function(e,i){return r("div",{key:e.optId,staticClass:"filter-opt-item",class:{selected:e.selected},on:{click:function(e){return t.optItemClick(0,i)}}},[t._v(" "+t._s(e.optDes)+" ")])})),0),r("div",{staticClass:"filter-btn"},[r("van-button",{attrs:{type:"danger",block:"",plain:"",round:"",size:"small"},on:{click:function(e){return t.filterReset(0)}}},[t._v(" "+t._s(t.$t("common.resetBtn"))+" ")]),r("van-button",{ref:"confirmBtn1",attrs:{type:"danger",block:"",round:"",size:"small"},on:{click:function(e){return t.filterAttrChange(0)}}},[t._v(" "+t._s(t.confirmBtnText)+" ")])],1)]):t._e(),t.filterAttr&&t.filterAttr.length>1?r("van-dropdown-item",{ref:"filterDropdown2",attrs:{title:t.filterAttr[1].des},on:{close:t.filterColse}},[r("div",{staticClass:"filter-attr-item"},t._l(t.filterAttr[1].dmList,(function(e,i){return r("div",{key:e.optId,staticClass:"filter-opt-item",class:{selected:e.selected},on:{click:function(e){return t.optItemClick(1,i)}}},[t._v(" "+t._s(e.optDes)+" ")])})),0),r("div",{staticClass:"filter-btn"},[r("van-button",{attrs:{type:"danger",block:"",plain:"",round:"",size:"small"},on:{click:function(e){return t.filterReset(1)}}},[t._v(" "+t._s(t.$t("common.resetBtn"))+" ")]),r("van-button",{ref:"confirmBtn2",attrs:{type:"danger",block:"",round:"",size:"small"},on:{click:function(e){return t.filterAttrChange(1)}}},[t._v(" "+t._s(t.confirmBtnText)+" ")])],1)]):t._e(),t.filterAttr&&t.filterAttr.length>0?r("van-dropdown-item",{ref:"filterDropdown3",staticClass:"filter-drop-menu",attrs:{title:t.$t("common.filter")},on:{close:t.filterColse}},[t._l(t.filterAttr,(function(e,i){return r("div",{key:e.type,staticClass:"filter-attr-item"},[r("div",{staticClass:"title"},[t._v(t._s(e.des))]),t._l(e.dmList,(function(e,s){return r("div",{key:e.optId,staticClass:"filter-opt-item",class:{selected:e.selected},on:{click:function(e){return t.optItemClick(i,s)}}},[t._v(" "+t._s(e.optDes)+" ")])}))],2)})),r("div",{staticClass:"filter-btn"},[r("van-button",{attrs:{type:"danger",block:"",plain:"",round:"",size:"small"},on:{click:function(e){return t.filterReset(2)}}},[t._v(" "+t._s(t.$t("common.resetBtn"))+" ")]),r("van-button",{ref:"confirmBtn3",attrs:{type:"danger",block:"",round:"",size:"small"},on:{click:function(e){return t.filterAttrChange(2)}}},[t._v(" "+t._s(t.confirmBtnText)+" ")])],1)],2):t._e()],1)],1)],1),t.showSkeleton?r("div",{staticClass:"skeleton-wrap"},[r("div",{staticClass:"loading-item"},[r("van-loading",{attrs:{type:"spinner"}}),r("van-skeleton",{attrs:{row:3}})],1),r("div",{staticClass:"loading-item"},[r("van-loading",{attrs:{type:"spinner"}}),r("van-skeleton",{attrs:{row:3}})],1),r("div",{staticClass:"loading-item"},[r("van-loading",{attrs:{type:"spinner"}}),r("van-skeleton",{attrs:{row:3}})],1),r("div",{staticClass:"loading-item"},[r("van-loading",{attrs:{type:"spinner"}}),r("van-skeleton",{attrs:{row:3}})],1)]):t._e(),t.showSkeleton?t._e():r("div",[t.tags&&t.tags.length>0?r("div",{staticClass:"tags-wrap"},[r("div",{staticClass:"tags-item-wrap"},t._l(t.tags,(function(e,i){return r("div",{key:i,staticClass:"tags-item",class:{selected:e.selected},on:{click:function(e){return t.tagItemClick(i)}}},[t._v(t._s(e.tagDes))])})),0),r("div",{staticClass:"product-total-wrap"},[r("div",{staticClass:"category-name"},[t._v(t._s(t.searchKey))]),r("div",{staticClass:"product-total"},[t._v("("+t._s(t.pageInfo?t.pageInfo.amount:0)+")")])])]):t._e(),t.productList.length>0?r("van-list",{attrs:{finished:t.finished,"immediate-check":!1,offset:"10"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.productList,(function(t,e){return r("ProductItem",{key:e,attrs:{data:t}})})),1):t._e(),0==t.productList.length?r("div",{staticClass:"empty-wrap"},[r("van-empty",{attrs:{description:t.$t("common.emptyData"),image:t.emptyImage}})],1):t._e()],1)],1)},s=[],n=r("1da1"),a=(r("96cf"),r("a434"),r("2ca0"),r("99af4"),r("159b"),r("9588")),o=r("c330"),c=r("90d3"),l=r("c4c8"),f=r("5d2d"),d={components:{ProductItem:a["a"],HeaderNav:o["a"],TopDiscount:c["a"]},data:function(){return{noData:!1,loading:!1,finished:!1,currentPage:0,pageInfo:{},searchKey:"",productList:[],optionSort:[{text:this.$t("list.sortType1"),value:1},{text:this.$t("list.sortType2"),value:2},{text:this.$t("list.sortType3"),value:3}],sortValue:1,showSkeleton:!1,emptyImage:r("31eb"),filterAttr:[],tags:[],oldFilterAttr:[],needFilter:!1,confirmBtnText:this.$t("common.confirmBtn",[""])}},created:function(){this.searchKey=this.$route.query.keyword,this.loadFirstPage();var t=Object(f["u"])(f["p"]);if(t&&t.length>0)for(var e=0;e<t.length;e++){var r=t[e];r===this.searchKey&&t.splice(e,1)}else t=[];t.push(this.searchKey),Object(f["x"])(f["p"],t),this.showSkeleton=!0},watch:{$route:function(t,e){t.path.startsWith("/search/result")&&t.params.id!==this.searchKey&&(this.searchKey=t.query.keyword,this.showSkeleton=!0,this.loadFirstPage())}},methods:{getProductListByKeyword:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.getFilterParams(),e.next=3,Object(l["o"])({currencyId:t.$store.state.currentCurrency.currencyCode,keyWord:t.searchKey,currentPage:t.currentPage,orderby:t.sortValue,filterObj:JSON.stringify(r)});case 3:i=e.sent,i.page?(1===t.currentPage&&(t.pageInfo=JSON.parse(JSON.stringify(i.page)),t.productList=[],t.showSkeleton=!1),t.productList=t.productList.concat(i.products)):(t.productList=[],t.showSkeleton=!1,t.$set(t.pageInfo,"amount",0)),t.confirmBtnText=t.$t("common.confirmBtn",["("+t.$t("detail.selectedAttrString",[t.pageInfo.amount])+")"]),t.setConfirmText(t.confirmBtnText),t.loading=!1;case 8:case"end":return e.stop()}}),e)})))()},onLoad:function(){this.productList.length>=this.pageInfo.amount?this.finished=!0:(this.currentPage=this.currentPage+1,this.getProductListByKeyword())},sortValueChange:function(){this.loadFirstPage()},loadFirstPage:function(){this.currentPage=1,this.finished=!1,this.loading=!1,this.filterAttr=[],this.oldFilterAttr=[],this.getFilterData(),this.getProductListByKeyword()},getFilterData:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["c"])({keyWord:t.searchKey});case 2:r=e.sent,t.filterAttr=r.fiterAttr,t.filterAttr.forEach((function(e){e.dmList.forEach((function(e){t.$set(e,"selected",!1)}))})),t.tags=r.tags,t.oldFilterAttr=JSON.parse(JSON.stringify(t.filterAttr));case 7:case"end":return e.stop()}}),e)})))()},filterAttrChange:function(t){this.needFilter=!0,0===t?this.$refs.filterDropdown1.toggle():1===t?this.$refs.filterDropdown2.toggle():2===t&&this.$refs.filterDropdown3.toggle()},filterReset:function(t){var e=this;if(t<2){var r=this.filterAttr[t];r.dmList.forEach((function(t){e.$set(t,"selected",!1)}))}else this.filterAttr.forEach((function(t){t.dmList.forEach((function(t){e.$set(t,"selected",!1)}))}));this.needFilter=!0,0===t?this.$refs.filterDropdown1.toggle():1===t?this.$refs.filterDropdown2.toggle():2===t&&this.$refs.filterDropdown3.toggle()},optItemClick:function(t,e){this.filterAttr[t].dmList[e].selected=!this.filterAttr[t].dmList[e].selected,this.requestFilterProductNumber()},filterColse:function(){this.needFilter?(this.needFilter=!1,this.oldFilterAttr=JSON.parse(JSON.stringify(this.filterAttr)),this.getProductListByKeyword()):(this.filterAttr=JSON.parse(JSON.stringify(this.oldFilterAttr)),this.setConfirmText(this.confirmBtnText))},getFilterParams:function(){var t={fiterAttr:[],tags:[]};this.filterAttr.forEach((function(e){var r=[];e.dmList.forEach((function(t){t.selected&&r.push({optId:t.optId,optDes:t.optDes})})),r.length>0&&t.fiterAttr.push({type:e.type,des:e.des,dmList:JSON.parse(JSON.stringify(r))})}));var e=[];return this.tags.forEach((function(t){t.selected&&e.push(t)})),t.tags=JSON.parse(JSON.stringify(e)),t},requestFilterProductNumber:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.getFilterParams(),e.next=3,Object(l["d"])({searchType:2,searchKey:t.searchKey,filterObj:JSON.stringify(r)});case 3:i=e.sent,t.setConfirmText(t.$t("common.confirmBtn",["("+t.$t("detail.selectedAttrString",[i])+")"]));case 5:case"end":return e.stop()}}),e)})))()},setConfirmText:function(t){this.$refs.confirmBtn1&&(this.$refs.confirmBtn1.getElementsByClassName("van-button__text")[0].innerText=t),this.$refs.confirmBtn2&&(this.$refs.confirmBtn2.getElementsByClassName("van-button__text")[0].innerText=t),this.$refs.confirmBtn3&&(this.$refs.confirmBtn3.getElementsByClassName("van-button__text")[0].innerText=t)},tagItemClick:function(t){this.$set(this.tags[t],"selected",!this.tags[t].selected),this.getProductListByKeyword()}}},u=d,h=(r("2ab1"),r("2877")),p=Object(h["a"])(u,i,s,!1,null,"ad285200",null);e["default"]=p.exports}}]);