(window.webpackJsonp=window.webpackJsonp||[]).push([["Advisory"],{"4fca":function(e,t,s){"use strict";s("ad4a")},5071:function(e,t,s){e.exports=s.p+"img/custom_service.png"},"5de7":function(e,t,s){"use strict";s.r(t);var n=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"user-image"},[t("img",{attrs:{src:s("5071"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"user-image"},[t("img",{attrs:{src:s("5071"),alt:""}})])}],a=(s("e7e5"),s("d399")),r=s("1da1"),i=(s("96cf"),s("159b"),s("c443")),c=s("fa7d"),o={data:function(){return{msgList:[],sendMessageContent:""}},created:function(){this.requestMyMsgList()},methods:{requestMyMsgList:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(i.a)({userId:e.$store.state.user.userId,infoType:"2"});case 2:s=t.sent,e.msgList=s.csInfo.chatlist,e.msgList.forEach((function(e){e.crtime=Object(c.m)(e.crtime),2===e.msgType&&(e.msgCnt=c.e+e.msgCnt)}));case 5:case"end":return t.stop()}}),t)})))()},sendTextMessage:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.sendMessageContent){t.next=3;break}return Object(a.a)("请填写问题内容"),t.abrupt("return");case 3:return t.next=5,Object(i.d)({userId:e.$store.state.user.userId,type:2,msgType:1,msgCnt:e.sendMessageContent}).then((function(t){e.sendMessageContent="",e.requestMyMsgList()}));case 5:case"end":return t.stop()}}),t)})))()},selectedImage:function(){var e=this.$refs.imageHeader.files[0];this.sendImageMessage(e)},sendImageMessage:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function s(){var n;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return(n=new FormData).append("imgfile",e),n.append("userId",t.$store.state.user.userId),s.next=5,Object(i.c)(n).then((function(e){200===e.status&&"0"===e.data.code?t.requestMyMsgList():a.a.fail("Image upload failed")}));case 5:case"end":return s.stop()}}),s)})))()}}},u=(s("4fca"),s("2877")),d=Object(u.a)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"messages-container"},[s("van-nav-bar",{staticClass:"app-nav-bar",attrs:{title:e.$t("message.advisory"),fixed:""}},[s("div",{attrs:{slot:"left"},slot:"left"},[s("i",{staticClass:"iconfont icon-fanhui",on:{click:function(t){return e.$router.go(-1)}}})])]),s("div",{staticClass:"messages-wrap"},[s("van-notice-bar",{attrs:{"left-icon":"volume-o",text:e.$t("message.answerHint")}}),e.msgList&&e.msgList.length>0?s("div",{staticClass:"message-list-wrap"},e._l(e.msgList,(function(t,n){return s("div",{key:n,staticClass:"message-item-wrap"},[s("div",{staticClass:"message-date"},[e._v(e._s(t.crtime))]),1!=t.isSelf?s("div",{staticClass:"other-item-wrap"},[e._m(0,!0),s("div",{staticClass:"msg-content-wrap"},[s("div",{staticClass:"msg-content"},[e._v(e._s(t.msgCnt))])])]):e._e(),1==t.isSelf?s("div",{staticClass:"self-item-wrap"},[s("div",{staticClass:"msg-content-wrap"},[1==t.msgType?s("div",{staticClass:"msg-content"},[e._v(e._s(t.msgCnt))]):e._e(),2==t.msgType?s("div",{staticClass:"msg-content"},[s("van-image",{attrs:{src:t.msgCnt},scopedSlots:e._u([{key:"loading",fn:function(){return[s("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0}],null,!0)})],1):e._e()]),e._m(1,!0)]):e._e()])})),0):e._e()],1),s("div",{staticClass:"bottom-wrap"},[s("van-field",{attrs:{placeholder:e.$t("message.advisoryHint"),clearable:"",border:!1},model:{value:e.sendMessageContent,callback:function(t){e.sendMessageContent=t},expression:"sendMessageContent"}}),e.sendMessageContent?s("van-button",{attrs:{type:"info"},on:{click:e.sendTextMessage}},[e._v(e._s(e.$t("message.sendBtn")))]):e._e(),e.sendMessageContent?e._e():s("div",{staticClass:"select-image-wrap"},[s("i",{staticClass:"iconfont icon-tianjia"}),s("input",{ref:"imageHeader",attrs:{type:"file",multiple:"",accept:"image/*"},on:{change:e.selectedImage}})])],1)],1)}),n,!1,null,"2a595738",null);t.default=d.exports},ad4a:function(e,t,s){},c443:function(e,t,s){"use strict";s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return o})),s.d(t,"d",(function(){return u})),s.d(t,"c",(function(){return d}));var n=s("b775"),a=s("cebe"),r=s.n(a),i=s("fa7d"),c=function(e){return Object(n.a)({url:"/msglist",data:e})},o=function(e){return Object(n.a)({url:"/getmsgsummary",data:e})},u=function(e){return Object(n.a)({url:"/sendmsg",data:e})},d=function(e){return r.a.post(i.a+"/sendimgmsg",e,{headers:{"Content-Type":"multipart/form-data"}})}}}]);