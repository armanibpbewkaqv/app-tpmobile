(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Bag"],{"08bd":function(t,i,n){},"24dc":function(t,i,n){"use strict";n("25de")},"25de":function(t,i,n){},"31eb":function(t,i,n){t.exports=n.p+"img/custom-empty-image.png"},"4ec9":function(t,i,n){"use strict";n("08bd")},"872c":function(t,i,n){},"9a83":function(t,i,n){"use strict";n("68ef"),n("a71a"),n("9d70"),n("3743"),n("4d75"),n("872c")},a434:function(t,i,n){"use strict";var s=n("23e7"),e=n("23cb"),o=n("a691"),a=n("50c4"),r=n("7b0b"),c=n("65f0"),u=n("8418"),l=n("1dde"),p=l("splice"),d=Math.max,h=Math.min,m=9007199254740991,f="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!p},{splice:function(t,i){var n,s,l,p,g,v,P=r(this),b=a(P.length),C=e(t,b),_=arguments.length;if(0===_?n=s=0:1===_?(n=0,s=b-C):(n=_-2,s=h(d(o(i),0),b-C)),b+n-s>m)throw TypeError(f);for(l=c(P,s),p=0;p<s;p++)g=C+p,g in P&&u(l,p,P[g]);if(l.length=s,n<s){for(p=C;p<b-s;p++)g=p+s,v=p+n,g in P?P[v]=P[g]:delete P[v];for(p=b;p>b-s+n;p--)delete P[p-1]}else if(n>s)for(p=b-s;p>C;p--)g=p+s-1,v=p+n-1,g in P?P[v]=P[g]:delete P[v];for(p=0;p<n;p++)P[p+C]=arguments[p+2];return P.length=b-s+n,l}})},a633:function(t,i,n){"use strict";n.r(i);var s=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{staticClass:"bag-container"},[n("van-nav-bar",{staticClass:"app-nav-bar",attrs:{title:t.$t("bag.title"),fixed:""}},[n("div",{staticClass:"left-wrap",attrs:{slot:"left"},slot:"left"},[n("i",{staticClass:"iconfont icon-fanhui",on:{click:t.goBack}})])]),t.isLoading?t._e():n("div",{staticClass:"middle-wrap"},[t.cartInfo&&t.cartInfo.cpPromptInfo?n("van-notice-bar",{attrs:{mode:"closeable",wrapable:""}},[t._v(t._s(t.cartInfo.cpPromptInfo))]):t._e(),t.showMakeUpHint?n("div",{staticClass:"price-range-wrap",on:{click:t.toPriceRange}},[n("i",{staticClass:"iconfont icon-yifahuo"}),n("div",{staticClass:"content",domProps:{innerHTML:t._s(t.$t("bag.addItemsHint",[t.cartInfo.freeShippingInfo,t.cartInfo.shippingCharge]))}}),t.hasPriceRange?n("i",{staticClass:"iconfont icon-xiangyou1"}):t._e()]):t._e(),t.cartInfo&&1==t.cartInfo.reachFreeShipping?n("div",{staticClass:"reach-free-shipping-wrap"},[n("i",{staticClass:"iconfont icon-yifahuo"}),n("div",[t._v(t._s(t.cartInfo.freeShippingInfo))])]):t._e(),0==t.cartList.length?n("div",{staticClass:"empty-bag-wrap"},[n("van-empty",{attrs:{description:t.$t("bag.empty"),image:t.emptyImage}},[t.isLogin?t._e():n("div",[t._v(t._s(t.$t("bag.emptyNoLogin")))])]),t.isLogin?t._e():n("div",{staticClass:"login-btn",on:{click:t.showPopup}},[t._v(t._s(t.$t("login.loginRegister")))]),t.isLogin?n("div",{staticClass:"shopping-btn",on:{click:t.toHome}},[t._v(t._s(t.$t("bag.shopNowBtn")))]):t._e()],1):t._e(),t.cartList.length>0?n("div",{staticClass:"bag-list-wrap"},t._l(t.cartList,(function(i,s){return n("div",{key:i.productColorId+s,staticClass:"product-item-wrap"},[n("van-image",{staticClass:"product-image",attrs:{src:i.displayImg,alt:"item.productName"},on:{click:function(i){return t.toProductDetail(s)}},scopedSlots:t._u([{key:"loading",fn:function(){return[n("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0}],null,!0)}),n("div",{staticClass:"product-info-wrap"},[n("div",[n("div",{staticClass:"product-name",on:{click:function(i){return t.toProductDetail(s)}}},[n("div",{staticClass:"name van-multi-ellipsis--l2"},[t._v(t._s(i.productName))]),n("i",{staticClass:"iconfont icon-shanchu",on:{click:function(i){return t.showDeleteDialog(i,s)}}})]),i.colorDes?n("div",{staticClass:"product-desc",on:{click:function(i){return t.toProductDetail(s)}}},[t._v(t._s(t.$t("detail.colorTitle"))+": "+t._s(i.colorDes))]):t._e(),i.attrDes?n("div",{staticClass:"product-desc",on:{click:function(i){return t.toProductDetail(s)}}},[t._v(t._s(i.attrDes))]):t._e()]),n("div",{staticClass:"product-price-number"},[n("div",{staticClass:"product-price"},[n("span",[t._v(t._s(i.unitPrice))]),n("del",[t._v(t._s(i.orgPrice))])]),n("div",{staticClass:"product-number"},[n("van-stepper",{attrs:{step:"1","disable-input":""},on:{change:function(i){return t.changeProductNumber(s)}},model:{value:i.productNum,callback:function(n){t.$set(i,"productNum",n)},expression:"item.productNum"}})],1)])])],1)})),0):t._e()],1),t.cartList.length>0?n("div",{staticClass:"bottom-wrap"},[n("div",{staticClass:"discount-wrap"},[n("van-cell",{attrs:{title:t.$t("coupon.couponCode"),"is-link":"",value:t.couponDis?t.couponDis:t.$t("bag.UseCouponHint")},on:{click:t.toCouponLList}}),n("van-cell",{attrs:{title:t.$t("point.title"),"is-link":"",value:t.points>0?t.points:t.$t("bag.UsePointsHint")},on:{click:t.showPointEditPop}})],1),n("div",{staticClass:"total-info"},[n("div",{staticClass:"price-wrap"},[n("div",[n("span",[t._v(t._s(t.$t("common.grandTotal")))]),n("span",[t._v(":")]),n("strong",{staticClass:"margin-left-5 price"},[t._v(t._s(t.totalPrice))])]),0!=t.savePrice?n("div",{staticClass:"save-wrap"},[n("span",[t._v(t._s(t.$t("bag.save")))]),n("span",[t._v(":")]),n("span",{staticClass:"margin-left-5"},[t._v(t._s(t.savePrice))]),n("span",{staticClass:"save-info-btn",on:{click:function(i){t.showSaveDetail=!0}}},[n("i",{staticClass:"iconfont icon-mingxi3"})])]):t._e()]),n("van-button",{staticClass:"checkout-btn",attrs:{"native-type":"submit",size:"large"},on:{click:t.toCheckout}},[t._v(t._s(t.$t("bag.checkoutBtn",[t.cartInfo.prdTotalNum])))])],1)]):t._e(),n("van-popup",{staticClass:"save-detail-pop",style:{height:"50%",width:"100%"},attrs:{position:"bottom",closeable:"","close-icon-position":"top-right"},model:{value:t.showSaveDetail,callback:function(i){t.showSaveDetail=i},expression:"showSaveDetail"}},[n("div",[n("div",{staticClass:"title"},[t._v(t._s(t.$t("bag.saveDetailTitle")))]),t.cartInfo.dis_info&&t.cartInfo.dis_info.length>0?n("div",{staticClass:"price-info-wrap"},t._l(t.cartInfo.dis_info,(function(i,s){return n("div",{key:s,staticClass:"price-item"},[n("div",{staticClass:"label"},[t._v(t._s(i.policyName))]),n("div",{class:i.isDiscount?"value green":"value"},[t._v(t._s(i.disAmount))])])})),0):t._e()]),n("div",{staticClass:"total-info"},[n("div",{staticClass:"price-wrap"},[n("div",[n("span",[t._v(t._s(t.$t("common.grandTotal")))]),n("span",[t._v(":")]),n("strong",{staticClass:"margin-left-5"},[t._v(t._s(t.totalPrice))])]),n("div",{staticClass:"save-wrap"},[n("span",[t._v(t._s(t.$t("bag.save")))]),n("span",[t._v(":")]),n("span",{staticClass:"margin-left-5"},[t._v(t._s(t.savePrice))]),n("span",{staticClass:"save-info-btn"},[n("i",{staticClass:"iconfont icon-mingxi3"})])])]),n("van-button",{staticClass:"checkout-btn",attrs:{"native-type":"submit",size:"large"},on:{click:t.toCheckout}},[t._v(t._s(t.$t("bag.checkoutBtn",[t.cartInfo.prdTotalNum])))])],1)]),n("van-popup",{staticClass:"point-edit-pop",style:{width:"100%"},attrs:{position:"bottom",closeable:"","close-icon-position":"top-right"},model:{value:t.showPointPop,callback:function(i){t.showPointPop=i},expression:"showPointPop"}},[n("PointEditPanel",{attrs:{close:t.hidePointEditPop,maxPoints:String(t.maxPoint),maxPointsPercent:t.maxPointsPercent},on:{transferPoint:t.applyPoint}})],1)],1)},e=[],o=(n("e17f"),n("2241")),a=(n("9a83"),n("f564")),r=n("1da1"),c=(n("96cf"),n("a9e3"),n("159b"),n("2ca0"),n("a434"),n("2166")),u=n("5d2d"),l=n("fa7d"),p=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{staticClass:"point-edit-wrap"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("point.userPoints")))]),n("div",{staticClass:"desc"},[t._v(" "+t._s(t.$t("point.maxAvailable"))+" "),n("strong",[t._v(t._s(t.maxPoints))]),n("i",{staticClass:"iconfont icon-wenhao",on:{click:t.showHintDialog}})]),n("div",{staticClass:"input-wrap"},[n("van-field",{attrs:{type:"digit",placeholder:t.$t("point.pointPlaceholder")},on:{input:t.pointChange},model:{value:t.applyPoints,callback:function(i){t.applyPoints=i},expression:"applyPoints"}}),n("div",{staticClass:"all-label",on:{click:t.allApplyPoint}},[t._v(t._s(t.$t("common.all")))])],1),n("div",{staticClass:"apply-btn-wrap"},[n("van-button",{staticClass:"apply-btn",attrs:{block:"",size:"normal",disabled:!t.applyPoints||0==t.applyPoints.length},on:{click:t.applyPoint}},[t._v(t._s(t.$t("common.applyBtn")))])],1)])},d=[],h={name:"PointEditPanel",props:{close:{type:Function},maxPoints:{type:String},maxPointsPercent:{type:String}},data:function(){return{inputPoints:this.getInputPoints(),applyPoints:this.getPoints()}},watch:{maxPoints:function(){this.applyPoints=this.getPoints()}},methods:{pointChange:function(t){Number(t)>this.maxPoints&&(this.applyPoints=this.maxPoints)},applyPoint:function(){this.close(),this.$store.commit("setInputPoint",this.applyPoints),this.$emit("transferPoint",this.applyPoints)},showHintDialog:function(){var t=this;o["a"].confirm({message:this.$t("point.pointHint",[this.maxPointsPercent]),cancelButtonText:this.$t("point.EarnPoints")}).then((function(){})).catch((function(){t.$router.push({path:"/point/rules"})}))},allApplyPoint:function(){this.applyPoints=this.maxPoints},getInputPoints:function(){return this.$store.state.inputPoint&&Number(this.$store.state.inputPoint)>0?Number(this.$store.state.inputPoint):0},getPoints:function(){return this.inputPoints=this.getInputPoints(),this.inputPoints>Number(this.maxPoints)?this.maxPoints:this.inputPoints}}},m=h,f=(n("24dc"),n("2877")),g=Object(f["a"])(m,p,d,!1,null,"6d0f50a3",null),v=g.exports,P={components:{PointEditPanel:v},data:function(){return{cartInfo:{},cartList:[],couponCode:this.$store.state.selectedCouponCode?this.$store.state.selectedCouponCode:"",couponDis:"",points:this.getInputPoints(),maxPoint:0,showMakeUpHint:!1,hasPriceRange:!1,maxProdcutNumber:3,showSaveDetail:!1,savePrice:0,isLoading:!0,emptyImage:n("31eb"),showPointPop:!1,maxPointsPercent:"50%"}},computed:{totalPrice:function(){return Object(l["n"])(this.cartInfo.realAmount,this.$store.state.currentCurrency)},isLogin:function(){return null!=this.$store.state.user}},watch:{isLogin:function(){this.getCartList()}},created:function(){var t=this.$store.state.systemInfo;t&&("0"!==t.price_arrange&&(this.hasPriceRange=!0),t.maxnum_allowed&&(this.maxProdcutNumber=Number(t.maxnum_allowed)))},mounted:function(){this.isLoading=!0,this.couponCode=this.$store.state.selectedCouponCode,this.getCartList()},methods:{toHome:function(){this.$router.push({path:"/"})},showPopup:function(){this.$store.commit("showLoginPanel")},getCartList:function(){if(this.$store.state.user){var t={currencyId:this.$store.state.currentCurrency.currencyCode,cart:[],userId:this.$store.state.user.userId,applyCpNo:this.couponCode,withShipping:0};this.getInputPoints()>0&&(t.points=this.getInputPoints()),this.requestCartList(t)}else{var i=Object(u["u"])(u["o"]);if(i&&i.length>0){var n={currencyId:this.$store.state.currentCurrency.currencyCode,cart:i,applyCpNo:this.couponCode,withShipping:0};this.requestCartList(n)}else this.cartList=[],this.$store.commit("setCartProductNumber",0),this.showMakeUpHint=!1,this.isLoading=!1}},requestCartList:function(t){var i=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(c["c"])({inputParams:JSON.stringify(t)});case 2:s=n.sent,s.cart&&s.cart.length>0?(i.cartList=s.cart,i.cartList.forEach((function(t){t.displayImg=l["f"]+t.displayImg,t.unitPrice=Object(l["n"])(t.unitPrice,i.$store.state.currentCurrency),t.orgPrice=Object(l["n"])(t.orgPrice,i.$store.state.currentCurrency)})),s.dis_info&&s.dis_info.length>0?(s.dis_info.unshift({disAmount:s.amount,policyId:"-1",policyName:i.$t("common.cartTotal")}),i.savePrice=Object(l["n"])(s.disamount,i.$store.state.currentCurrency)):(s.dis_info=[],s.dis_info.unshift({disAmount:s.amount,policyId:"-1",policyName:i.$t("common.cartTotal")}),i.savePrice=s.disamount),s.dis_info.forEach((function(t){t.disAmount=String(t.disAmount),t.disAmount.startsWith("-")?(t.disAmount="-"+Object(l["n"])(t.disAmount.substring(1),i.$store.state.currentCurrency),t.isDiscount=!0):(t.disAmount=Object(l["n"])(t.disAmount,i.$store.state.currentCurrency),t.isDiscount=!1)})),s.applyCpNo?i.$store.commit("setSelectedCoupon",s.applyCpNo):i.$store.commit("setSelectedCoupon","")):(i.cartList=[],i.showMakeUpHint=!1,i.$store.commit("setCartProductNumber",0)),s.maxpoints&&(i.maxPoint=s.maxpoints,i.maxPoint<i.getInputPoints()?(i.points=i.maxPoint,Object(a["a"])({type:"warning",message:i.$t("point.maxPointHint",[i.points])})):i.points=i.getInputPoints()),s.maxPointsPercent&&(i.maxPointsPercent=s.maxPointsPercent),s.coupondis?i.couponDis="-"+Object(l["n"])(s.coupondis,i.$store.state.currentCurrency):i.couponDis="",0===s.reachFreeShipping?i.showMakeUpHint=!0:i.showMakeUpHint=!1,i.cartInfo=s,s.prdTotalNum||(s.prdTotalNum=0),i.$store.commit("setCartProductNumber",s.prdTotalNum),i.isLoading=!1;case 12:case"end":return n.stop()}}),n)})))()},toCheckout:function(){if(this.$store.state.user){if(this.cartInfo.prdTotalNum>this.maxProdcutNumber){var t=this.$t("checkout.maxNumberHint",[this.maxProdcutNumber]);return void Object(a["a"])({type:"warning",message:t})}if(this.cartInfo.realAmount>this.cartInfo.amountAllowed){var i=this.$t("checkout.maxAmountHint",[this.totalPrice,Object(l["n"])(this.cartInfo.amountAllowed,this.$store.state.currentCurrency)]);return void Object(a["a"])({type:"warning",message:i})}this.$router.push({path:"/checkout"})}else this.$store.commit("showLoginPanel"),this.showSaveDetail=!1},showDeleteDialog:function(t,i){var n=this;t.stopPropagation(),o["a"].confirm({title:this.$t("bag.deleteProductTitle"),message:this.$t("bag.deleteProductContent")}).then((function(){n.delProduct(i)})).catch((function(){}))},delProduct:function(t){this.changeProductNumber(t,0)},changeProductNumber:function(t,i){if(0===i&&(this.cartList[t].productNum=0),this.$store.state.user){var n=this.cartList[t];n.userId=this.$store.state.user.userId,this.requestChangeCart({inputParams:JSON.stringify([n])})}else{var s=Object(u["u"])(u["o"]);if(s&&s.length>0){for(var e=0;e<s.length;e++)if(e===t){0===this.cartList[t].productNum?s.splice(t,1):s[e].productNum=this.cartList[t].productNum;break}Object(u["x"])(u["o"],s)}this.getCartList()}},requestChangeCart:function(t){var i=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(c["b"])(t).then((function(){i.getCartList()}));case 2:case"end":return n.stop()}}),n)})))()},toCouponLList:function(){this.$router.push({path:"/coupons",query:{type:1}})},toPriceRange:function(){this.hasPriceRange&&this.$router.push({path:"/bag/pricerange"})},toProductDetail:function(t){this.$router.push("/detail/"+Object(l["l"])(this.cartList[t].productId)+"/"+Object(l["l"])(this.cartList[t].productColorId))},showPointEditPop:function(){this.$store.state.user?this.showPointPop=!0:this.$store.commit("showLoginPanel")},hidePointEditPop:function(){this.showPointPop=!1},applyPoint:function(t){this.points=t,this.getCartList()},getInputPoints:function(){return this.$store.state.inputPoint&&Number(this.$store.state.inputPoint)>0?Number(this.$store.state.inputPoint):0},goBack:function(){window.history.state?this.$router.go(-1):this.toHome()}}},b=P,C=(n("4ec9"),Object(f["a"])(b,s,e,!1,null,"c855154e",null));i["default"]=C.exports},f564:function(t,i,n){"use strict";var s=n("c31d"),e=n("a026"),o=n("2638"),a=n.n(o),r=n("d282"),c=n("ba31"),u=n("6605"),l=n("e41f"),p=Object(r["a"])("notify"),d=p[0],h=p[1];function m(t,i,n,s){var e={color:i.color,background:i.background};return t(l["a"],a()([{attrs:{value:i.value,position:"top",overlay:!1,duration:.2,lockScroll:!1},style:e,class:[h([i.type]),i.className]},Object(c["b"])(s,!0)]),[(null==n.default?void 0:n.default())||i.message])}m.props=Object(s["a"])({},u["b"],{color:String,message:[Number,String],duration:[Number,String],className:null,background:String,getContainer:[String,Function],type:{type:String,default:"danger"}});var f,g,v=d(m),P=n("a142");function b(t){return Object(P["e"])(t)?t:{message:t}}function C(t){if(!P["g"])return g||(g=Object(c["c"])(v,{on:{click:function(t){g.onClick&&g.onClick(t)},close:function(){g.onClose&&g.onClose()},opened:function(){g.onOpened&&g.onOpened()}}})),t=Object(s["a"])({},C.currentOptions,b(t)),Object(s["a"])(g,t),clearTimeout(f),t.duration&&t.duration>0&&(f=setTimeout(C.clear,t.duration)),g}function _(){return{type:"danger",value:!0,message:"",color:void 0,background:void 0,duration:3e3,className:"",onClose:null,onClick:null,onOpened:null}}C.clear=function(){g&&(g.value=!1)},C.currentOptions=_(),C.setDefaultOptions=function(t){Object(s["a"])(C.currentOptions,t)},C.resetDefaultOptions=function(){C.currentOptions=_()},C.install=function(){e["a"].use(v)},C.Component=v,e["a"].prototype.$notify=C;i["a"]=C}}]);