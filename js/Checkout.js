(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Checkout"],{"40cf":function(t,e,s){"use strict";s("ecad")},"872c":function(t,e,s){},"9a83":function(t,e,s){"use strict";s("68ef"),s("a71a"),s("9d70"),s("3743"),s("4d75"),s("872c")},a924:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"checkout-container"},[s("van-nav-bar",{staticClass:"app-nav-bar",attrs:{title:t.$t("checkout.title"),fixed:""}},[s("div",{attrs:{slot:"left"},slot:"left"},[s("i",{staticClass:"iconfont icon-fanhui",on:{click:function(e){return t.$router.go(-1)}}})])]),s("div",{staticClass:"main-content"},[s("div",{staticClass:"shipping-address-wrap",on:{click:t.selectAddress}},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("address.title")))]),s("div",{staticClass:"address-wrap"},[t.currentAddress?s("div",{staticClass:"address-info-wrap"},[s("div",{staticClass:"name-wrap"},[s("span",{staticClass:"name"},[t._v(t._s(t.currentAddress.recFirstname))]),s("span",{staticClass:"name"},[t._v(t._s(t.currentAddress.recLastname))]),s("span",{staticClass:"phone"},[t._v(t._s(t.currentAddress.telephone))])]),s("div",{staticClass:"address"},[t._v(t._s(t.currentAddress.streetAddr)+" "+t._s(t.currentAddress.extendAddr))]),s("div",{staticClass:"address"},[t._v(t._s(t.currentAddress.city)+" "+t._s(t.currentAddress.province)+" "+t._s(t.currentAddress.fullCountry)+" "+t._s(t.currentAddress.postCode))])]):t._e(),t.currentAddress?t._e():s("div",{class:t.isRed?"empty-address-wrap red":"empty-address-wrap"},[t._v(" "+t._s(t.$t("checkout.empty"))+" ")]),s("i",{staticClass:"iconfont icon-xiangyou1"})])]),s("div",{staticClass:"shipping-method-wrap"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("checkout.deliveryTitle")))]),s("div",{staticClass:"shipping-method-item"},[s("i",{staticClass:"iconfont icon-yifahuo"}),s("div",{staticClass:"shipping-info"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("checkout.shipingChargesTitle")))]),s("div",{staticClass:"desc"},[t._v(t._s(t.$t("checkout.shipingChargesDesc")))])]),s("div",{staticClass:"price"},[t._v(t._s(t.cartInfo.shippingCost))])])]),s("div",{staticClass:"payment-method-wrap"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("checkout.paymentMethod")))]),t._m(0)]),s("div",{staticClass:"shopping-bag-wrap"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("bag.title")))]),s("div",{staticClass:"product-list-wrap"},t._l(t.cartList,(function(e,r){return s("div",{key:r,staticClass:"product-item-wrap"},[s("van-image",{attrs:{src:e.displayImg,alt:e.productName},scopedSlots:t._u([{key:"loading",fn:function(){return[s("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0}],null,!0)}),s("div",{staticClass:"number"},[t._v("x"+t._s(e.productNum))])],1)})),0)]),t.cartInfo.dis_info&&t.cartInfo.dis_info.length>0?s("div",{staticClass:"price-info-wrap"},t._l(t.cartInfo.dis_info,(function(e,r){return s("div",{key:r,staticClass:"price-item"},[s("div",{staticClass:"label"},[t._v(t._s(e.policyName))]),s("div",{class:e.isDiscount?"value green":"value"},[t._v(t._s(e.disAmount))])])})),0):t._e()]),s("div",{staticClass:"bottom-wrap"},[s("div",{staticClass:"total-info"},[s("span",[t._v(t._s(t.$t("common.grandTotal")))]),s("span",{staticClass:"price"},[t._v(t._s(t.totalPrice))])]),s("div",{staticClass:"point-hint"},[s("div",{staticClass:"point-hint-text",domProps:{innerHTML:t._s(t.$t("checkout.pointTitle",{msg:t.earnPoints}))}}),s("i",{staticClass:"iconfont icon-wenhao",on:{click:t.showPointDialog}})]),s("van-button",{staticClass:"place-order-btn",attrs:{size:"large"},on:{click:t.newOrder}},[t._v(t._s(t.$t("checkout.placeOrderBtn")))])],1)],1)},n=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"payment-method-item"},[r("img",{attrs:{src:s("aec3"),alt:""}})])}],i=(s("e7e5"),s("d399")),a=(s("9a83"),s("f564")),c=(s("e17f"),s("2241")),o=s("1da1"),d=(s("96cf"),s("a9e3"),s("159b"),s("2ca0"),s("c24f")),u=s("2166"),l=s("f8b7"),p=s("fa7d"),h=s("5d2d"),m={data:function(){return{currentAddress:null,cartInfo:{},cartList:[],couponCode:this.$store.state.selectedCouponCode,maxProdcutNumber:3,earnPoints:"",isRed:!1}},computed:{totalPrice:function(){return Object(p["n"])(this.cartInfo.realAmount,this.$store.state.currentCurrency)}},created:function(){this.$store.state.user?(this.getAddressList(),this.getCartList()):this.$store.commit("showLoginPanel");var t=this.$store.state.systemInfo;t&&t.maxnum_allowed&&(this.maxProdcutNumber=Number(t.maxnum_allowed))},mounted:function(){this.$store.state.selectedAddress&&(this.currentAddress=JSON.parse(JSON.stringify(this.$store.state.selectedAddress)),this.$store.commit("setSelectedAddress",null))},methods:{getAddressList:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var s,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(d["f"])({userId:t.$store.state.user.userId,addrType:"0"});case 2:if(s=e.sent,!(s instanceof Array&&s.length>0)){e.next=14;break}r=0;case 5:if(!(r<s.length)){e.next=13;break}if(n=s[r],1!==n.isDefault||null!=t.currentAddress){e.next=10;break}return t.currentAddress=n,e.abrupt("break",13);case 10:r++,e.next=5;break;case 13:null==t.currentAddress&&(t.currentAddress=s[0]);case 14:case"end":return e.stop()}}),e)})))()},getCartList:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var s,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={currencyId:t.$store.state.currentCurrency.currencyCode,cart:[],userId:t.$store.state.user.userId,applyCpNo:t.couponCode,withShipping:1},r=t.getPoints(),r>0&&(s.points=r),e.next=5,Object(u["c"])({inputParams:JSON.stringify(s)});case 5:n=e.sent,n.cart&&n.cart.length>0&&(t.cartList=n.cart,t.cartList.forEach((function(e){e.displayImg=p["f"]+e.displayImg,e.unitPrice=Object(p["n"])(e.unitPrice,t.$store.state.currentCurrency)}))),n.dis_info&&n.dis_info.length>0&&(n.dis_info.unshift({disAmount:n.amount,policyId:"-1",policyName:t.$t("common.cartTotal")}),n.dis_info.forEach((function(e){e.disAmount=String(e.disAmount),e.disAmount.startsWith("-")?(e.disAmount="-"+Object(p["n"])(e.disAmount.substring(1),t.$store.state.currentCurrency),e.isDiscount=!0):(e.disAmount=Object(p["n"])(e.disAmount,t.$store.state.currentCurrency),e.isDiscount=!1)}))),(n.shippingCost||0===n.shippingCost)&&(n.shippingCost=Object(p["n"])(n.shippingCost,t.$store.state.currentCurrency)),n.earnPoints&&(t.earnPoints=n.earnPoints),t.cartInfo=n;case 11:case"end":return e.stop()}}),e)})))()},selectAddress:function(){this.currentAddress?this.$router.push({path:"/address",query:{addrId:this.currentAddress.addrId}}):this.$router.push({path:"/address/edit"})},newOrder:function(){var t=this;if(null==this.currentAddress)return c["a"].alert({message:this.$t("checkout.noShippingAddress"),width:"300px"}).then((function(){t.$router.push({path:"/address/edit"})})),void(this.isRed=!0);if(this.cartInfo.prdTotalNum>this.maxProdcutNumber){var e=this.$t("checkout.maxNumberHint",[this.maxProdcutNumber]);Object(a["a"])({type:"warning",message:e})}else if(this.cartInfo.realAmount>this.cartInfo.amountAllowed){var s=this.$t("checkout.maxAmountHint",[this.totalPrice,Object(p["n"])(this.cartInfo.amountAllowed,this.$store.state.currentCurrency)]);Object(a["a"])({type:"warning",message:s})}else{var r={currencyId:this.$store.state.currentCurrency.currencyCode,userId:this.$store.state.user.userId,adsAccount:Object(h["v"])(h["b"]),memo:"",spAddr:{userId:this.currentAddress.userId,country:this.currentAddress.country,fullCountry:this.currentAddress.fullCountry,province:this.currentAddress.province,city:this.currentAddress.city,extendAddr:this.currentAddress.extendAddr,streetAddr:this.currentAddress.streetAddr,email:this.currentAddress.email,postCode:this.currentAddress.postCode,telephone:this.currentAddress.telephone,telephone1:this.currentAddress.telephone1,recFirstname:this.currentAddress.recFirstname,recLastname:this.currentAddress.recLastname,addrId:this.currentAddress.addrId},applyCpNo:this.couponCode,withShipping:1},n=this.getPoints();n>0&&(r.points=n),this.requestNewOrder(r)}},getPoints:function(){return this.$store.state.inputPoint&&Number(this.$store.state.inputPoint)>0?Number(this.$store.state.inputPoint):0},requestNewOrder:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,Object(l["h"])({inputParams:JSON.stringify(t)}).then((function(t){i["a"].success(e.$t("checkout.orderSuccess")),e.$router.push({path:"/payment",query:{orderId:t.orderId}}),e.$store.commit("setCartProductNumber",0),e.$store.commit("setSelectedCoupon",""),e.$store.commit("setInputPoint",0)}));case 2:case"end":return s.stop()}}),s)})))()},toCouponLList:function(){this.$router.push({path:"/coupons",query:{type:1}})},showPointDialog:function(){c["a"].alert({message:this.$t("checkout.pointHint")}).then((function(){}))}}},f=m,v=(s("40cf"),s("2877")),C=Object(v["a"])(f,r,n,!1,null,"52693ff2",null);e["default"]=C.exports},aec3:function(t,e,s){t.exports=s.p+"img/vmj.jpg"},ecad:function(t,e,s){},f564:function(t,e,s){"use strict";var r=s("c31d"),n=s("a026"),i=s("2638"),a=s.n(i),c=s("d282"),o=s("ba31"),d=s("6605"),u=s("e41f"),l=Object(c["a"])("notify"),p=l[0],h=l[1];function m(t,e,s,r){var n={color:e.color,background:e.background};return t(u["a"],a()([{attrs:{value:e.value,position:"top",overlay:!1,duration:.2,lockScroll:!1},style:n,class:[h([e.type]),e.className]},Object(o["b"])(r,!0)]),[(null==s.default?void 0:s.default())||e.message])}m.props=Object(r["a"])({},d["b"],{color:String,message:[Number,String],duration:[Number,String],className:null,background:String,getContainer:[String,Function],type:{type:String,default:"danger"}});var f,v,C=p(m),g=s("a142");function A(t){return Object(g["e"])(t)?t:{message:t}}function y(t){if(!g["g"])return v||(v=Object(o["c"])(C,{on:{click:function(t){v.onClick&&v.onClick(t)},close:function(){v.onClose&&v.onClose()},opened:function(){v.onOpened&&v.onOpened()}}})),t=Object(r["a"])({},y.currentOptions,A(t)),Object(r["a"])(v,t),clearTimeout(f),t.duration&&t.duration>0&&(f=setTimeout(y.clear,t.duration)),v}function b(){return{type:"danger",value:!0,message:"",color:void 0,background:void 0,duration:3e3,className:"",onClose:null,onClick:null,onOpened:null}}y.clear=function(){v&&(v.value=!1)},y.currentOptions=b(),y.setDefaultOptions=function(t){Object(r["a"])(y.currentOptions,t)},y.resetDefaultOptions=function(){y.currentOptions=b()},y.install=function(){n["a"].use(C)},y.Component=C,n["a"].prototype.$notify=y;e["a"]=y}}]);