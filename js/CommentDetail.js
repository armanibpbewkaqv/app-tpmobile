(window.webpackJsonp=window.webpackJsonp||[]).push([["CommentDetail"],{"25ce":function(t,e,r){"use strict";r.r(e),r("e7e5");var c,n=r("d399"),o=r("1da1"),a=r("ade3"),s=(r("4662"),r("28a2")),i=(r("96cf"),r("b0c0"),r("159b"),r("063c")),u=r("cf78"),d=r("58b3"),l=r("fa7d"),p={components:(c={},Object(a.a)(c,s.a.Component.name,s.a.Component),Object(a.a)(c,"ProductDetailPanel",u.a),Object(a.a)(c,"ReviewItem",d.a),c),data:function(){return{cmId:this.$route.query.cmId,productInfo:"",commentInfo:null,leaveMsgList:[],showDetailsPop:!1,sendContent:"",femaleHeader:r("7869"),maleHeader:r("257f")}},mounted:function(){this.requestCommentDetail(),this.requestLeaveMsgList()},methods:{requestCommentDetail:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.b)({cmId:t.cmId,userId:t.$store.state.user?t.$store.state.user.userId:""});case 2:(r=e.sent).productImg=l.f+r.productImg,t.commentInfo=r;case 5:case"end":return e.stop()}}),e)})))()},requestLeaveMsgList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.e)({cmId:t.cmId});case 2:(r=e.sent).forEach((function(t){t.crtime=Object(l.m)(t.crtime)})),t.leaveMsgList=r;case 5:case"end":return e.stop()}}),e)})))()},imagePre:function(t,e,r){t.stopPropagation();var c=[];e.forEach((function(t){c.push(t)})),Object(s.a)({images:c,startPosition:r,closeable:!0})},showProductDetail:function(){this.showDetailsPop=!0},hideDetailPop:function(){this.showDetailsPop=!1},commitReply:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$store.state.user){e.next=4;break}t.$store.commit("showLoginPanel"),e.next=10;break;case 4:if(!t.sendContent){e.next=9;break}return e.next=7,Object(i.h)({cmId:t.cmId,userId:t.$store.state.user.userId,msg:t.sendContent}).then((function(e){t.requestCommentDetail(),t.requestLeaveMsgList(),t.sendContent=""}));case 7:e.next=10;break;case 9:Object(n.a)("请输入评论内容");case 10:case"end":return e.stop()}}),e)})))()},refreshItem:function(){this.requestCommentDetail()}}},m=(r("94ee"),r("2877")),f=Object(m.a)(p,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"review-detail-container"},[r("van-nav-bar",{staticClass:"app-nav-bar",attrs:{title:"Evaluation Detail",fixed:""}},[r("div",{attrs:{slot:"left"},slot:"left"},[r("i",{staticClass:"iconfont icon-fanhui",on:{click:function(e){return t.$router.go(-1)}}})])]),t.commentInfo?r("div",{staticClass:"review-detail-wrap"},[r("div",{staticClass:"product-info-wrap"},[r("van-image",{staticClass:"product-image",attrs:{src:t.commentInfo.productImg,alt:"product.productName"},scopedSlots:t._u([{key:"loading",fn:function(){return[r("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0}],null,!1,2352118052)}),r("div",{staticClass:"product-info"},[r("div",[t._v(t._s(t.commentInfo.productName))]),t.commentInfo.colorDes?r("div",[t._v(t._s(t.commentInfo.colorDes))]):t._e(),t.commentInfo.attrDes?r("div",[t._v(t._s(t.commentInfo.attrDes))]):t._e()]),r("div",{staticClass:"add-cart-wrap",on:{click:t.showProductDetail}},[r("i",{staticClass:"iconfont icon-jiarugouwuche"})])],1),r("div",{staticClass:"review-list-wrap"},[r("ReviewItem",{attrs:{comment:t.commentInfo},on:{transferRefresh:t.refreshItem}})],1),r("div",{staticClass:"reply-list-wrap"},[r("div",{staticClass:"title"},[t._v(t._s(t.$t("comment.commentMsgNumber",[t.leaveMsgList.length])))]),r("div",{staticClass:"reply-list"},t._l(t.leaveMsgList,(function(e,c){return r("div",{key:c,staticClass:"reply-item-wrap"},[r("div",{staticClass:"user-info-wrap"},[r("van-image",{staticClass:"user-image",attrs:{round:"",fit:"cover",src:t.femaleHeader}}),r("div",{staticClass:"user-name-date"},[r("div",{staticClass:"name"},[t._v(t._s(e.submiter))]),r("div",{staticClass:"date"},[t._v(t._s(e.crtime))])])],1),r("div",{staticClass:"content"},[t._v(" "+t._s(e.content)+" ")])])})),0)])]):t._e(),r("div",{staticClass:"bottom-wrap"},[r("van-field",{attrs:{placeholder:t.$t("comment.commentMsgPlaceholder"),clearable:"",border:!1},model:{value:t.sendContent,callback:function(e){t.sendContent=e},expression:"sendContent"}}),r("div",{staticClass:"send-btn",on:{click:t.commitReply}},[r("i",{staticClass:"iconfont icon-fasong"})])],1),r("van-popup",{style:{height:"80%",width:"100%"},attrs:{closeable:"",position:"bottom"},model:{value:t.showDetailsPop,callback:function(e){t.showDetailsPop=e},expression:"showDetailsPop"}},[r("ProductDetailPanel",{attrs:{productId:this.productInfo.productId,productColorId:this.productInfo.productColorId,close:t.hideDetailPop}})],1)],1)}),[],!1,null,"623a8aea",null);e.default=f.exports},"3ecc":function(t,e,r){"use strict";r("c9e6")},"94ee":function(t,e,r){"use strict";r("9c81")},"9c81":function(t,e,r){},c4c8:function(t,e,r){"use strict";r.d(e,"m",(function(){return n})),r.d(e,"k",(function(){return o})),r.d(e,"l",(function(){return a})),r.d(e,"b",(function(){return s})),r.d(e,"a",(function(){return i})),r.d(e,"o",(function(){return u})),r.d(e,"j",(function(){return d})),r.d(e,"i",(function(){return l})),r.d(e,"d",(function(){return p})),r.d(e,"c",(function(){return m})),r.d(e,"g",(function(){return f})),r.d(e,"e",(function(){return h})),r.d(e,"f",(function(){return v})),r.d(e,"h",(function(){return g})),r.d(e,"n",(function(){return _}));var c=r("b775"),n=function(t){return Object(c.a)({url:"/productsbymenuandtag",data:t})},o=function(t){return Object(c.a)({url:"/menucustomcontent",data:t})},a=function(t){return Object(c.a)({url:"/product_detail",data:t})},s=function(t){return Object(c.a)({url:"/getallviewofprd",data:t})},i=function(t){return Object(c.a)({url:"/attention",data:t})},u=function(t){return Object(c.a)({url:"/search_products",data:t})},d=function(t){return Object(c.a)({url:"/products_rel",data:t})},l=function(t){return Object(c.a)({url:"/getmenuadscnt",data:t})},p=function(t){return Object(c.a)({url:"/countproduct",data:t})},m=function(t){return Object(c.a)({url:"/filterattrbysearchkey",data:t})},f=function(t){return Object(c.a)({url:"/flashsalesummry",data:t})},h=function(t){return Object(c.a)({url:"/flashsalefilter",data:t})},v=function(t){return Object(c.a)({url:"/flashsaleproducts",data:t})},g=function(t){return Object(c.a)({url:"/curflashsaleproducts",data:t})},_=function(t){return Object(c.a)({url:"/listimgwall",data:t})}},c9e6:function(t,e,r){},cf78:function(t,e,r){"use strict";r("e7e5");var c=r("d399"),n=r("1da1"),o=(r("96cf"),r("159b"),r("fa7d")),a=r("c4c8"),s=r("2166"),i=r("5d2d"),u={name:"ProductDetailPanel",props:{productId:{type:String},productColorId:{type:String},close:{type:Function}},data:function(){return{productInfo:{},currentProduct:null,productNumber:1}},watch:{productId:function(){this.getProductDetail()}},computed:{productImageList:function(){return this.currentProduct&&this.currentProduct.img_groups?(this.currentProduct.img_groups.forEach((function(t){t.big_img=o.f+t.big_img})),this.currentProduct.img_groups):[]},productSalePrice:function(){return this.currentProduct.original_price?Object(o.n)(this.currentProduct.current_price,this.$store.state.currentCurrency):""},productOldPrice:function(){return this.currentProduct.current_price?Object(o.n)(this.currentProduct.original_price,this.$store.state.currentCurrency):""},showColorWrap:function(){var t=this.$store.state.systemInfo;return!(!t||"1"!==t.img_block&&"2"!==t.img_block)}},created:function(){this.getProductDetail()},methods:{getProductDetail:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.l)({currencyId:t.$store.state.currentCurrency.currencyCode,productId:t.productId,userId:t.$store.state.user?t.$store.state.user.userId:null});case 2:r=e.sent,t.productInfo=r,t.productInfo.color_data.forEach((function(e){e.color_img=o.f+e.color_img,e.img_display=o.f+e.img_display,e.color_id===t.productColorId&&(t.currentProduct=e)}));case 5:case"end":return e.stop()}}),e)})))()},chooseAttrItem:function(t,e,r){this.$set(this.currentProduct.dyn_attrs[e],"selectedAttr",{attrOptId:t.domain_list[r].optId,attrType:t.attrID,attrString:t.attr_name+":"+t.domain_list[r].optName})},toProductDetail:function(){this.close(),this.$router.push("/detail/"+Object(o.l)(this.productId)+"/"+Object(o.l)(this.currentProduct.color_id))},addProductToBag:function(){for(var t=[],e=0;e<this.currentProduct.dyn_attrs.length;e++){var r=this.currentProduct.dyn_attrs[e];if(!r.selectedAttr)return void Object(c.a)(this.$t("detail.noSelectedAttr",[r.attr_name]));t.push(r.selectedAttr)}this.$store.state.user?this.addProductForUser(t):this.addProductForLocal(t)},addProductForUser:function(t){var e=[{userId:this.$store.state.user.userId,productName:this.currentProduct.pcName,productImage:this.currentProduct.img_display,productId:this.productId,productColorId:this.currentProduct.color_id,productNum:this.productNumber,attrOpts:t}];this.requestAddProductToBag(e)},addProductForLocal:function(t){var e={productName:this.currentProduct.pcName,productImage:this.currentProduct.img_display,productId:this.productId,productColorId:this.currentProduct.color_id,productNum:this.productNumber,attrOpts:t},r=Object(i.u)(i.o);if(r){for(var n=-1,o=0;o<r.length;o++){var a=r[o];if(this.isSameProduct(e,a)){n=o;break}}-1===n?r.push(e):r[n].productNum=r[n].productNum+this.productNumber,Object(i.x)(i.o,JSON.stringify(r))}else Object(i.x)(i.o,[e]);this.$store.commit("setCartProductNumber",this.$store.state.cartProductNumber+this.productNumber),c.a.success(this.$t("common.addSuccess")),this.close()},isSameProduct:function(t,e){if(t.productId!==e.productId||t.productColorId!==e.productColorId)return!1;if(t.attrOpts.length!==e.attrOpts.length)return!1;for(var r=0;r<t.attrOpts.length;r++){var c=t.attrOpts[r],n=e.attrOpts[r];if(c.attrType!==n.attrType||c.attrOptId!==n.attrOptId)return!1}return!0},requestAddProductToBag:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(s.a)({inputParams:JSON.stringify(t),userid:e.$store.state.user?e.$store.state.user.userId:null}).then((function(){c.a.success(e.$t("common.addSuccess")),e.close(),e.$store.commit("setCartProductNumber",e.$store.state.cartProductNumber+e.productNumber)})).catch((function(){c.a.success(e.$t("common.addFail"))}));case 2:case"end":return r.stop()}}),r)})))()},colorItemClick:function(t){this.currentProduct=this.productInfo.color_data[t]}}},d=(r("3ecc"),r("2877")),l=Object(d.a)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.currentProduct?r("div",{staticClass:"product-detail-container"},[r("div",{staticClass:"product-infor-wrap"},[r("div",{staticClass:"product-image-wrap"},t._l(t.productImageList,(function(e,c){return r("div",{key:c},[r("van-image",{staticClass:"product-image",attrs:{src:e.big_img,alt:t.currentProduct.pcName},scopedSlots:t._u([{key:"loading",fn:function(){return[r("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0}],null,!0)})],1)})),0),r("div",{staticClass:"product-info-wrap"},[r("div",{staticClass:"product-name-wrap"},[r("div",{staticClass:"product-name"},[t._v(t._s(t.currentProduct.pcName))])]),r("div",{staticClass:"product-price-wrap"},[r("div",{staticClass:"price-wrap"},[r("span",[t._v(t._s(t.productSalePrice))]),r("del",[t._v(t._s(t.productOldPrice))])]),r("div",{staticClass:"detail-wrap",on:{click:t.toProductDetail}},[r("span",[t._v(t._s(t.$t("detail.detailLabel")))]),r("i",{staticClass:"iconfont icon-xiangyou1"})])])]),t.showColorWrap?r("div",{staticClass:"product-color-wrap"},[r("div",{staticClass:"title-wrap"},[r("div",{staticClass:"title"},[t._v(t._s(t.$t("detail.colorTitle")))])]),t._l(t.productInfo.color_data,(function(e,c){return r("div",{key:e.color_id,staticClass:"color-image-wrap",on:{click:function(e){return t.colorItemClick(c)}}},[r("van-image",{class:{selected:t.currentProduct.color_id==e.color_id},attrs:{src:e.color_img,alt:"colorItem.pcName"},scopedSlots:t._u([{key:"loading",fn:function(){return[r("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0}],null,!0)})],1)}))],2):t._e(),t._l(t.currentProduct.dyn_attrs,(function(e,c){return r("div",{key:e.attrID,staticClass:"product-size-wrap"},[r("div",{staticClass:"title-wrap"},[r("div",{staticClass:"title"},[t._v(t._s(e.attr_name))])]),r("div",{staticClass:"size-wrap"},t._l(e.domain_list,(function(n,o){return r("div",{key:n.optId,staticClass:"size-item",class:{selected:e.selectedAttr&&e.selectedAttr.attrOptId==n.optId},on:{click:function(r){return t.chooseAttrItem(e,c,o)}}},[t._v(t._s(n.optName))])})),0)])}))],2),r("div",{staticClass:"add-btn",on:{click:t.addProductToBag}},[t._v(t._s(t.$t("detail.addToBagBtn")))])]):t._e()}),[],!1,null,"38f32f28",null);e.a=l.exports}}]);